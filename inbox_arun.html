<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Inbox Arun</title>

<style>
body{
  margin:0;
  background:#000;
  color:#fff;
  font-family:Segoe UI,Arial;
  padding:10px;
}

table{
  width:100%;
  border-collapse:collapse;
}

th,td{
  padding:8px;
  border-bottom:1px solid #222;
  font-size:14px;
}

th{
  background:#111;
  text-align:left;
}

.red-age{
  background:#8b0000;
  color:#fff;
}
</style>
</head>

<body>

<h3>Inbox - Arun</h3>

<table id="dataTable">
  <thead>
    <tr>
      <th>Date</th>
      <th>Age</th>
      <th>AIC</th>
      <th>Customer</th>
      <th>Vehicle</th>
      <th>Executive</th>
      <th>Chase</th>
    </tr>
  </thead>
  <tbody></tbody>
</table>

<script>
const API =
"https://script.google.com/macros/s/YOUR_DEPLOYMENT_ID/exec?mode=inbox_arun";

function loadData(){
  fetch(API,{cache:"no-store"})
  .then(r=>r.json())
  .then(data=>{
    const tbody=document.querySelector("#dataTable tbody");
    tbody.innerHTML="";

    data.forEach(row=>{
      const tr=document.createElement("tr");

      row.forEach((cell,index)=>{
        const td=document.createElement("td");
        td.textContent=cell;

        // jobcard_age column (index 1)
        if(index===1){
          const age=parseInt(cell);
          if(!isNaN(age) && age>60){
            td.classList.add("red-age");
          }
        }

        tr.appendChild(td);
      });

      tbody.appendChild(tr);
    });
  });
}

// First load
loadData();

// Silent auto refresh every 30 sec
setInterval(loadData,30000);
</script>

</body>
</html>
